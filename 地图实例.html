<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="./css/Reset.css">
    <link rel="stylesheet" href="./css/element-ui@2.15.1/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="./css/swiper.css">

    <style>
        .chart_box {
            width: 1000px;
            height: 500px;
            border: 1px solid;
        }
    </style>
</head>

<body>
    <div id="app" class="wrap">

        <div class="item_box">
            <div class="chart_box" id="echartsMap">

            </div>
        </div>
    </div>

    </div>
</body>

<script src="./js/vue@2.6.12"></script>
<script src="./js/element-ui@2.15.1.js"></script>
<script src="./js/jquery-2.2.1.min.js"></script>
<!-- <script src="./js/echarts@5.1.0/dist/echarts.min.js"></script> -->
<script src="./js/echarts.js"></script>
<script src="./data/js/china.js"></script>
<!-- <script src="./data/json/china.json"></script> -->
<!-- <script src="./js/flexible.js"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/echarts@5.1.0/dist/echarts.min.js"></script> -->
<script src="./js/less.js"></script>
<script src="./js/swiper.min.js"></script>
<script src="./js/axios.min.js"></script>
<script src="./js/axios.js"></script>
<script>
    new Vue({
        el: "#app",
        data: function() {
            return {
                // moneyScalePlate: 500,
                timeValue: ""
            }
        },
        mounted() {
            this.getCountryList()
        },
        methods: {
            // 将坐标与值对应并反映在地图上
            convertData(data) {
                var res = [];
                var that = this
                for (var i = 0; i < data.length; i++) {
                    var geoCoord = that.geoCoordMap[data[i].name];
                    // console.log('geoCoord',geoCoord)
                    if (geoCoord) {
                        res.push({
                            name: data[i].name,
                            value: geoCoord.concat(data[i].value)
                        });
                    }
                }
                return res;
            },
            // 获取近5年
            getYearList() {
                var yearArr = [];
                var myDate = new Date();
                nowYear = myDate.getFullYear(); //当前年
                this.timeValue = nowYear
                for (var int = nowYear - 4; int <= nowYear; int++) {
                    yearArr.push({
                        label: int,
                        value: int
                    });
                }
                return yearArr.reverse();
            },
            /*获取数据*/
            getData() {
                let that = this
                    // server.getTradeoverview({
                    //     tradeflow: that.tradeflow,
                    //     year: parseInt(that.timeValue),
                    //     hscode: that.industryCode
                    // }).then(function(res) {
                let res = {
                        data: {
                            section: [1, 2, 3]
                        }
                    }
                    // that.result = res.data
                var tempStr = that.tradeflow == 'export' ? '出口' : '进口'
                that.pieces = [{
                        min: res.data.section[3],
                        label: '大于' + res.data.section[3],
                        color: '#3267D7'
                    }, // 不指定 max，表示 max 为无限大（Infinity）。
                    {
                        min: res.data.section[2],
                        max: res.data.section[3],
                        label: res.data.section[2] + '-' + res.data.section[3],
                        color: '#1681F0'
                    }, {
                        min: res.data.section[1],
                        max: res.data.section[2],
                        label: res.data.section[1] + '-' + res.data.section[2],
                        color: '#41ABFF'
                    }, {
                        min: res.data.section[0],
                        max: res.data.section[1],
                        label: res.data.section[0] + '-' + res.data.section[1],
                        color: '#A3CBFF'
                    }, {
                        min: 0,
                        max: res.data.section[0],
                        label: '0-' + res.data.section[0],
                        color: '#bdd2ec'
                    }, {
                        value: 0,
                        label: '无数据',
                        color: '#EDEDED'
                    }
                ]
                that.tempData = that.dataDeal(res.data.map)
                that.getCountryList()
                    // })
            },
            /*转换数据格式给地图着色*/
            dataDeal(list) {
                var tempArr = []
                list.forEach(function(item, index) {
                    // console.log('11111-----',item)
                    tempArr.push({
                        name: item.countryCode,
                        value: item.amountCurrent,
                        other: item
                    })
                })
                return tempArr
            },
            /*切换年份*/
            changeOption() {
                this.getData()
            },
            /*生成地图*/
            getCountryList() {
                var that = this;
                let uploadedDataURL = "data/json/world.json";
                /* 根据请求的数据实例化地图 */
                var chart = echarts.init(document.getElementById('echartsMap'));
                $.getJSON(uploadedDataURL, function(geoJson) {

                    echarts.registerMap('world', geoJson);
                })
                chart.setOption({
                        visualMap: { // 分区域着色
                            //min: 0,
                            //max: 2200000,
                            type: 'piecewise',
                            // splitNumber:5, //对于连续型数据，自动平均切分成几段。默认为5段
                            hoverLink: false,
                            itemWidth: 12, //图形的宽度，即长条的宽度。
                            itemHeight: 12, //图形的高度，即长条的高度。
                            showLabel: true, //是否显示每项的文本标签。默认情况是，如果text 被使用则不显示文本标签，否则显示。
                            pieces: that.pieces,
                            text: ['单位:万元'], // 两端的文本，如['High', 'Low']
                            textStyle: { //文本样式
                                color: '#777F86'
                            },
                            bottom: 15 // 组件离容器下侧的距离
                        },
                        // 移到国家上的效果
                        tooltip: {
                            trigger: 'item',
                            padding: 0,
                            enterable: true,
                            transitionDuration: 1,
                            textStyle: {
                                color: '#818A91',
                                decoration: 'none',
                            },
                            backgroundColor: 'rgba(255,255,255,0.96)',
                            // borderColor:'#000000',
                            //borderWidth: 1,
                            formatter: function(params) {
                                //console.log('移到某个国家上:',params)
                                var tipHtml = '';
                                if (params.data && params.data.other) {
                                    tipHtml = '<div style="font-size:13px;min-width:300px;box-shadow: 0px 1px 4px 0px rgba(0, 0, 0, 0.3);border-radius:4px;padding:30px 20px;">' +
                                        '<div style="font-size: 16px;color:#333333;">' + params.data.other.countryName + '</div>' +
                                        '<div style="padding:6px 0;"><i style="display: inline-block;margin-bottom: 3px;width:6px;margin-right:6px;height: 6px;background: #3472EE;border-radius: 50%;"></i>' + that.timeValue + '年整体进口额为' + (params.data.other.amountCurrent || 0) + '万元;</div>' +
                                        '<div style="padding:6px 0;"><i style="display: inline-block;margin-bottom: 3px;width:6px;margin-right:6px;height: 6px;background: #3472EE;border-radius: 50%;"></i>' + that.timeValue + '年整体进口所占份额为' + (params.data.other.marketShare || 0) + '%;</div>' +
                                        '<div style="padding:6px 0;"><i style="display: inline-block;margin-bottom: 3px;width:6px;margin-right:6px;height: 6px;background: #3472EE;border-radius: 50%;"></i>' + that.timeValue + '年年进口额增长率为' + (params.data.other.growthRate || 0) + '%;</div>' +
                                        '</div>'
                                } else {
                                    tipHtml = '<div style="font-size:13px;min-width:300px;box-shadow: 0px 1px 4px 0px rgba(0, 0, 0, 0.3);border-radius:4px;padding:30px 20px;">' +
                                        '<div style="font-size: 16px;color:#333333;">' + that.nameMap[params.name] + '</div>' +
                                        '<div style="text-align:center;padding:20px 0 10px;">无数据</div>' +
                                        '</div>'
                                }

                                return tipHtml;
                            }
                        },
                        geo: {
                            type: 'map',
                            name: '世界地图',
                            map: 'world',
                            roam: true, // 是否开启鼠标缩放和平移漫游
                            itemStyle: { // 每个区域的样式
                                normal: {
                                    areaColor: '#EDEDED',
                                    borderColor: '#D3D7E1', // 图形的描边颜色
                                    borderWidth: 1 //描边线宽
                                },
                                emphasis: { // 高亮状态
                                    label: {
                                        show: false // 去除鼠标移到地图上，地图上显示国家名的效果
                                    }
                                    //areaColor: '#7d7d7d'
                                }
                            },
                            scaleLimit: { // 缩放的极限控制
                                min: 1,
                                max: 3
                            },
                            left: 40, // 组件离容器左侧的距离
                            top: 80, // 组件离容器上侧的距离
                            right: 80,
                            //nameMap: that.nameMap, //自定义地区的名称映射(bug1:加了这个visualMap会错乱)
                            data: that.tempData
                        },
                        series: [{
                                type: 'map',
                                name: '世界地图',
                                map: 'world',
                                geoIndex: 0, // (bug fixed:解决在地图上缩放重影问题：https://www.dazhuanlan.com/2019/11/30/5de14b1b3aa97/)
                                roam: true, // 是否开启鼠标缩放和平移漫游
                                itemStyle: { // 每个区域的样式
                                    normal: {
                                        areaColor: '#EDEDED',
                                        borderColor: '#D3D7E1', // 图形的描边颜色
                                        borderWidth: 1 //描边线宽
                                    },
                                    emphasis: { // 高亮状态
                                        label: {
                                            show: false // 去除鼠标移到地图上，地图上显示国家名的效果
                                        }
                                        //areaColor: '#7d7d7d'
                                    }
                                },
                                scaleLimit: { // 缩放的极限控制
                                    min: 1,
                                    max: 3
                                },
                                left: 40, // 组件离容器左侧的距离
                                top: 80, // 组件离容器上侧的距离
                                right: 80,
                                //nameMap: that.nameMap, //自定义地区的名称映射(bug1:加了这个visualMap会错乱)
                                data: that.tempData
                            },

                        ]
                    }, true)
                    // 地图点击事件
                chart.on('click', function(params) {
                    console.log('---params----', params)
                })
            },
            initTimeline() {
                let uploadedDataURL = "data/json/china.json";
                // var uploadedDataURL = "/asset/get/s/data-1528971808162-BkOXf61WX.json";
                let $mapBox = echarts.init(document.getElementById("mapBox"))

                var geoCoordMap = {
                    "江苏": [118.8062, 31.9208],
                    '黑龙江': [127.9688, 45.368],
                    '内蒙古': [110.3467, 41.4899],
                    "吉林": [125.8154, 44.2584],
                    '北京市': [116.4551, 40.2539],
                    "辽宁": [123.1238, 42.1216],
                    "河北": [114.4995, 38.1006],
                    "天津": [117.4219, 39.4189],
                    "山西": [112.3352, 37.9413],
                    "陕西": [109.1162, 34.2004],
                    "甘肃": [103.5901, 36.3043],
                    "宁夏": [106.3586, 38.1775],
                    "青海": [101.4038, 36.8207],
                    "新疆": [87.9236, 43.5883],
                    "四川": [103.9526, 30.7617],
                    "重庆": [108.384366, 30.439702],
                    "山东": [117.1582, 36.8701],
                    "河南": [113.4668, 34.6234],
                    "安徽": [117.29, 32.0581],
                    "湖北": [114.3896, 30.6628],
                    "浙江": [119.5313, 29.8773],
                    "福建": [119.4543, 25.9222],
                    "江西": [116.0046, 28.6633],
                    "湖南": [113.0823, 28.2568],
                    "贵州": [106.6992, 26.7682],
                    "云南": [102.9199, 25.4663],
                    "广东": [113.12244, 23.009505],
                    "广西": [108.479, 23.1152],
                    "海南": [110.3893, 19.8516],
                    '上海': [121.4648, 31.2891],
                    "西藏": [115.0648, 28.6744],
                };


                var d1 = {
                    '江苏': 15520.7,
                    '黑龙江': 4684.1,
                    '内蒙古': 1828.3,
                    '吉林': 3500.4,
                    '北京市': 6506.3,
                    '辽宁': 9417.2,
                    '河北': 6072.5,
                    '天津': 1830.0,
                    '山西': 3416.8,
                    '陕西': 7418.8,
                    '甘肃': 3898.6,
                    '宁夏': 918.6,
                    '青海': 544.4,
                    '新疆': 3717.6,
                    '四川': 13827.4,
                    '重庆': 6839.9,
                    '山东': 7437.8,
                    '河南': 14018.0,
                    '安徽': 13955.3,
                    '湖北': 10073,
                    '浙江': 13014.5,
                    '福建': 5871.9,
                    '江西': 6779.5,
                    '湖南': 16183.7,
                    '贵州': 8657.1,
                    '云南': 4908.0,
                    '广东': 18078.9,
                    '广西': 5190.4,
                    '海南': 1421.0,
                    '上海': 1331.7,
                    '西藏': 990.5,

                };

                var d2 = {
                    "江苏": 13830.8,
                    '黑龙江': 4286.9,
                    '内蒙古': 1612.5,
                    "吉林": 3635.9,
                    '北京市': 6284.9,
                    "辽宁": 7369.2,
                    "河北": 5327.4,
                    "天津": 1834.5,
                    "山西": 2961.2,
                    "陕西": 6968.0,
                    "甘肃": 4045.3,
                    "宁夏": 9300,
                    "青海": 5602,
                    "新疆": 3594.8,
                    "四川": 13596.9,
                    "重庆": 6228.3,
                    "山东": 6035.6,
                    "河南": 12501.5,
                    "安徽": 8681.0,
                    "湖北": 10203.5,
                    "浙江": 11136.9,
                    "福建": 5164.6,
                    "江西": 6241.8,
                    "湖南": 1313.11,
                    "贵州": 8754.1,
                    "云南": 4879.4,
                    "广东": 12392.6,
                    "广西": 4910.1,
                    '海南': 1372.8,
                    '上海': 1384.4,
                    '西藏': 922.5,

                };

                var d3 = {
                    '江苏': 13358.0,
                    '黑龙江': 3938.6,
                    '内蒙古': 1573.5,
                    '吉林': 3491.0,
                    '北京市': 6151.9,
                    '辽宁': 7363.2,
                    '河北': 5070.1,
                    '天津': 1837.7,
                    '山西': 2637.4,
                    '陕西': 6982.0,
                    '甘肃': 4162.6,
                    '宁夏': 8757,
                    '青海': 5934,
                    '新疆': 3214.8,
                    '四川': 12374.6,
                    '重庆': 6125.5,
                    '山东': 6346.3,
                    '河南': 12052.8,
                    '安徽': 8110.6,
                    '湖北': 10299.0,
                    '浙江': 10501.8,
                    '福建': 5164.9,
                    '江西': 6287.6,
                    '湖南': 12176,
                    '贵州': 8946.4,
                    '云南': 4651.9,
                    '广东': 13034.5,
                    '广西': 4869.9,
                    '海南': 1391.2,
                    '上海': 1441.6,
                    '西藏': 930.5,


                };

                var d4 = {
                    "江苏": 12678.3,
                    '黑龙江': 3467,
                    '内蒙古': 1486.7,
                    "吉林": 3298.9,
                    '北京市': 5887.1,
                    "辽宁": 7248.3,
                    "河北": 5002.3,
                    "天津": 1744,
                    "山西": 2515.5,
                    "陕西": 6788,
                    "甘肃": 4263.8,
                    "宁夏": 7345,
                    "青海": 6274,
                    "新疆": 2708.3,
                    "四川": 10909.3,
                    "重庆": 6052.2,
                    "山东": 6529.9,
                    "河南": 11435.1,
                    "安徽": 6910.5,
                    "湖北": 10314.4,
                    "浙江": 10449.7,
                    "福建": 5113.4,
                    "江西": 6299.7,
                    "湖南": 11493.6,
                    "贵州": 9180.3,
                    "云南": 4462.2,
                    "广东": 13741.8,
                    "广西": 4857.8,
                    '海南': 1466,
                    '上海': 1548.5,
                    '西藏': 970.5,
                };

                var d5 = {
                    '江苏': 12061.2,
                    '黑龙江': 3156.8,
                    '内蒙古': 1326.8,
                    '吉林': 3195.6,
                    '北京市': 5893.5,
                    '辽宁': 7134.3,
                    '河北': 4734.6,
                    '天津': 1745,
                    '山西': 2383.7,
                    '陕西': 7158.3,
                    '甘肃': 4218.5,
                    '宁夏': 6137,
                    '青海': 6443,
                    '新疆': 2120.4,
                    '四川': 9856.9,
                    '重庆': 6058.7,
                    '山东': 6744.3,
                    '河南': 11042.1,
                    '安徽': 6334.7,
                    '湖北': 9835,
                    '浙江': 9838,
                    '福建': 4810.5,
                    '江西': 6068.6,
                    '湖南': 10668,
                    '贵州': 9302.5,
                    '云南': 4148.4,
                    '广东': 14214.4,
                    '广西': 4793.1,
                    '海南': 1438.3,
                    '上海': 1584.5,
                    '西藏': 880.5,


                };

                var d6 = {
                    "江苏": 12029.8,
                    '黑龙江': 2975.1,
                    '内蒙古': 1215.8,
                    "吉林": 3159.9,
                    '北京市': 6297.7,
                    "辽宁": 7026.6,
                    "河北": 4473.3,
                    "天津": 1767.9,
                    "山西": 2230.5,
                    "陕西": 7076.1,
                    "甘肃": 4213.3,
                    "宁夏": 5754,
                    "青海": 6313,
                    "新疆": 2027.6,
                    "四川": 9166.8,
                    "重庆": 6015.3,
                    "山东": 6892,
                    "河南": 10929.7,
                    "安徽": 5927.5,
                    "湖北": 8743.2,
                    "浙江": 10189.3,
                    "福建": 4576.1,
                    "江西": 5806.9,
                    "湖南": 10142.8,
                    "贵州": 9375.6,
                    "云南": 3838.1,
                    "广东": 14232.6,
                    "广西": 4708.5,
                    '海南': 1418.7,
                    '上海': 1644.2,
                    '西藏': 790.5,
                };

                var colors = [
                    ["#1DE9B6", "#1DE9B6", "#FFDB5C", "#FFDB5C", "#04B9FF", "#04B9FF"],
                    ["#1DE9B6", "#F46E36", "#04B9FF", "#5DBD32", "#FFC809", "#FB95D5", "#BDA29A", "#6E7074", "#546570", "#C4CCD3"],
                    ["#37A2DA", "#67E0E3", "#32C5E9", "#9FE6B8", "#FFDB5C", "#FF9F7F", "#FB7293", "#E062AE", "#E690D1", "#E7BCF3", "#9D96F5", "#8378EA", "#8378EA"],
                    ["#DD6B66", "#759AA0", "#E69D87", "#8DC1A9", "#EA7E53", "#EEDD78", "#73A373", "#73B9BC", "#7289AB", "#91CA8C", "#F49F42"],
                ];
                var colorIndex = 0;


                var monthes = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
                var mapData = [
                    [],
                    [],
                    [],
                    [],
                    [],
                    [],
                ];

                /*柱子Y名称*/
                var categoryData = [];
                var barData = [];

                for (var key in geoCoordMap) {
                    mapData[0].push({
                        "year": '2014',
                        "name": key,
                        "value": d1[key] / 100,
                        "value1": d1[key] / 100,
                    });
                    mapData[1].push({
                        "year": '2015',
                        "name": key,
                        "value": d1[key] / 100,
                        "value1": d2[key] / 100,
                    });
                    mapData[2].push({
                        "year": '2016',
                        "name": key,
                        "value": d3[key] / 100,
                        "value1": d3[key] / 100,
                    });
                    mapData[3].push({
                        "year": '2017',
                        "name": key,
                        "value": d3[key] / 100,
                        "value1": d4[key] / 100,
                    });
                    mapData[4].push({
                        "year": '2018',
                        "name": key,
                        "value": d5[key] / 100,
                        "value1": d5[key] / 100,
                    });
                    mapData[5].push({
                        "year": '2019',
                        "name": key,
                        "value": d5[key] / 100,
                        "value1": d6[key] / 100,
                    });
                }
                console.log("mapData", mapData)
                $.getJSON(uploadedDataURL, function(geoJson) {

                    echarts.registerMap('china', geoJson);
                    var convertData = function(data) {
                        var res = [];
                        for (var i = 0; i < data.length; i++) {
                            var geoCoord = geoCoordMap[data[i].name];
                            if (geoCoord) {
                                res.push({
                                    name: data[i].name,
                                    value: geoCoord.concat(data[i].value)
                                });
                            }
                        }
                        return res;
                    };

                    var convertToLineData = function(data, gps) {
                        var res = [];
                        //流
                        for (var i = 0; i < data.length; i++) {
                            var dataItem = data[i];
                            var toCoord = geoCoordMap[dataItem.name];
                            debugger;
                            var fromCoord = gps;
                            if (fromCoord && toCoord) {
                                res.push([{
                                    coord: fromCoord,
                                    value: dataItem.value
                                }, {
                                    coord: toCoord,
                                }]);
                            }
                        }
                        return res;
                    };

                    optionXyMap01 = {
                        timeline: {
                            data: monthes,
                            axisType: 'category',
                            orient: 'vertical',
                            autoPlay: true,
                            playInterval: 5000,
                            left: 30,
                            right: null,
                            top: 50,
                            bottom: 20,
                            width: 55,
                            height: "70%",
                            inverse: true,
                            label: {
                                show: true,
                                normal: {
                                    fontSize: "12",
                                    textStyle: {
                                        color: '#FFFFFF'
                                    },
                                },
                                emphasis: {
                                    textStyle: {
                                        color: '#fff'
                                    },
                                    fontSize: "12",
                                }
                            },
                            symbol: "circle",
                            symbolSize: 10,
                            lineStyle: {
                                show: true,
                                color: '#0554A3'
                            },
                            itemStyle: {
                                normal: {
                                    color: "#0554A3",
                                }
                            },
                            checkpointStyle: {
                                color: '#207CFE',
                                borderColor: '#207CFE',
                                borderWidth: 1,
                                symbolSize: '12',
                            },
                            controlStyle: {
                                show: false
                            }
                        },
                        baseOption: {
                            animation: true,
                            animationDuration: 1000,
                            animationEasing: 'cubicInOut',
                            animationDurationUpdate: 1000,
                            animationEasingUpdate: 'cubicInOut',
                            grid: {
                                right: '1%',
                                top: '15%',
                                bottom: '10%',
                                width: '20%'
                            },
                            tooltip: {
                                trigger: 'item', // hover触发器
                                backgroundColor: "transparent",
                                borderColor: "transparent",
                                formatter: function(params) {
                                    console.log("params", params)
                                    if (params.componentType === "timeline") return
                                        // return params
                                    let htmlStr = `
                                            <div class="maptooltip_box">
                                                <h4>中标情况</h4>
                                                <div class="maptooltip_cont">
                                                    <p>城市办 <span>张毅伟</span> 中标500W</p>
                                                    <p>城市办 <span>张毅伟</span> 中标500W</p>
                                                    <p>城市办 <span>张毅伟</span> 中标500W</p>
                                                    <p>城市办 <span>张毅伟</span> 中标500W</p>
                                                </div>
                                            </div>
                                            `
                                    return htmlStr;
                                }
                            },
                            geo: {
                                show: true,
                                map: 'china',
                                roam: true,
                                zoom: 1.2,
                                geoIndex: 2,
                                center: [105, 35.9234],
                                label: {
                                    emphasis: {
                                        show: false
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        borderColor: 'rgba(147, 235, 248, 0.6)',
                                        borderWidth: 1,
                                        areaColor: {
                                            type: 'radial',
                                            x: 0.5,
                                            y: 0.5,
                                            r: 0.8,
                                            colorStops: [{
                                                offset: 0,
                                                color: 'rgba(147, 235, 248, 0)' // 0% 处的颜色
                                            }, {
                                                offset: 1,
                                                color: 'rgba(147, 235, 248, .2)' // 100% 处的颜色
                                            }],
                                            globalCoord: false // 缺省为 false
                                        }
                                    },
                                    emphasis: {
                                        areaColor: 'inherit',
                                        borderWidth: 2,
                                        borderColor: 'rgba(0, 255, 246, 1)',
                                    }
                                }
                            },
                            visualMap: {
                                type: 'piecewise',
                                right: '2%',
                                bottom: '2%',
                                pieces: [{
                                        gt: 500,
                                        color: "#207CFE",
                                        label: '中标500W以上'
                                    }, // (1500, Infinity]
                                    {
                                        gt: 300,
                                        color: "#3AA0FF",
                                        lte: 500,
                                        label: '中标300W-500W以上'
                                    }, // (100, 200]
                                    {
                                        gt: 100,
                                        color: "#418DFF",
                                        lte: 300,
                                        label: '中标100W-300W以上'
                                    }, // (100, 200]
                                    {
                                        lt: 100,
                                        color: "#7FC9FB",
                                        label: '中标100W以下'
                                    } // (-Infinity, 100)
                                ],
                                align: "left",
                                textStyle: {
                                    color: "#fff"
                                }
                            },
                        },
                        options: []

                    };
                    for (var n = 0; n < monthes.length; n++) {
                        optionXyMap01.options.push({
                            // backgroundColor: '#000000',
                            series: [
                                //地图？
                                {
                                    type: 'map',
                                    map: 'china',
                                    geoIndex: 0,
                                    aspectScale: 0.75, //长宽比
                                    showLegendSymbol: false, // 存在legend时显示
                                    label: {
                                        emphasis: {
                                            show: true,
                                            color: "#fff"
                                        },
                                        normal: {
                                            show: true,
                                            color: "#fff"
                                        }
                                    },
                                    // emphasis: {
                                    //     itemStyle: {
                                    //         areaColor: "#3066ba",
                                    //         borderColor: "#00FFF6"
                                    //     },
                                    // },
                                    // roam: true,

                                    // animation: false,
                                    data: this.mapData
                                }
                            ]
                        })
                    }
                    $mapBox.setOption(optionXyMap01);
                });

            },
            initTimeline() {
                let $mapBox = echarts.init(document.getElementById("mapBox"))
                window.addEventListener('resize', function() {
                    $mapBox.resize();
                });
                let url = "/data/json/china.json"
                $.getJSON(url, function(csJson) {
                    echarts.registerMap('china', csJson);
                    // dt
                    // var chart = echarts.init(document.getElementById('map'));
                    // chart.setOption(option);
                });
                let monthes = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
                let con = [198];
                let itemStyle = {
                    normal: {
                        opacity: 0.8,
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowOffsetY: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                };
                let option = {
                    timeline: {
                        // data: this.mapData.map(function(ele) {
                        //     return ele.time
                        // }),
                        data: monthes,
                        axisType: 'category',
                        orient: 'vertical',
                        autoPlay: true,
                        playInterval: 5000,
                        left: 30,
                        right: null,
                        top: 50,
                        bottom: 20,
                        width: 55,
                        height: "70%",
                        inverse: true,
                        //  height: null,
                        label: {
                            show: true,
                            normal: {
                                fontSize: "12",
                                textStyle: {
                                    color: '#FFFFFF'
                                },
                            },
                            emphasis: {
                                textStyle: {
                                    color: '#fff'
                                },
                                fontSize: "12",
                            }
                        },
                        symbol: "circle",
                        symbolSize: 10,
                        lineStyle: {
                            show: true,
                            color: '#0554A3'
                        },
                        itemStyle: {
                            normal: {
                                color: "#0554A3",
                            }
                        },
                        checkpointStyle: {
                            color: '#207CFE',
                            borderColor: '#207CFE',
                            borderWidth: 1,
                            symbolSize: '12',
                        },
                        controlStyle: {
                            show: false
                        }
                    },
                    baseOption: {
                        tooltip: {
                            trigger: 'item', // hover触发器
                            backgroundColor: "transparent",
                            borderColor: "transparent",
                            formatter: function(params) {
                                // console.log("params", params)
                                if (params.componentType === "timeline" || !params.data) return
                                    // return params
                                let htmlStr = `
                                        <div class="maptooltip_box">
                                            <h4>中标情况</h4>
                                            <div class="maptooltip_cont">
                                                <p>${params.data.name} <span>张毅伟</span> 中标${params.data.value}W</p>
                                            </div>
                                        </div>
                                        `
                                return htmlStr;
                            }
                        },
                        title: {
                            text: '',
                            textAlign: 'center',
                            left: 180,
                            bottom: 10,
                            textStyle: {
                                fontSize: 70,
                                color: 'rgba(255, 255, 255, 0.5)'
                            }
                        },
                        visualMap: {
                            type: 'piecewise',
                            right: '2%',
                            bottom: '2%',
                            pieces: [{
                                    gt: 500,
                                    color: "#207CFE",
                                    label: '中标500W以上'
                                }, // (1500, Infinity]
                                {
                                    gt: 300,
                                    color: "#3AA0FF",
                                    lte: 500,
                                    label: '中标300W-500W以上'
                                }, // (100, 200]
                                {
                                    gt: 100,
                                    color: "#418DFF",
                                    lte: 300,
                                    label: '中标100W-300W以上'
                                }, // (100, 200]
                                {
                                    lt: 100,
                                    color: "#7FC9FB",
                                    label: '中标100W以下'
                                } // (-Infinity, 100)
                            ],
                            align: "left",
                            textStyle: {
                                color: "#fff"
                            }
                        },
                        geo: {
                            map: 'china',
                            roam: true,
                            zoom: 1.4,
                            // geoIndex: 2,
                            label: {
                                normal: {
                                    show: false,
                                    textStyle: {
                                        color: 'rgba(0,0,0,0.4)'
                                    }
                                }
                            },
                            itemStyle: {
                                normal: {
                                    borderColor: 'rgba(0, 0, 0, 0.2)'
                                },
                                emphasis: {
                                    areaColor: 'rgba(32, 124, 254, 1)',
                                    borderWidth: 1,
                                    borderColor: 'rgba(0, 255, 246, 1)',
                                    shadowOffsetX: 0,
                                    shadowOffsetY: 0,
                                    shadowBlur: 20,
                                    // borderWidth: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        },
                    },
                    options: []
                };
                for (var i = 0; i < this.mapData.length; i++) {

                    option.options.push({
                        series: [{
                            type: "map",
                            mapType: "china",
                            roam: true,
                            geoIndex: 0,
                            // zoom: 2.2,
                            scaleLimit: {
                                min: 0.7,
                                max: 3
                            },
                            center: "center",
                            label: {
                                emphasis: {
                                    show: true,
                                    color: "#fff",
                                    // areaColor: 'inherit',
                                    // borderWidth: 2,
                                    // borderColor: 'rgba(0, 255, 246, 1)',
                                },
                                normal: {
                                    show: false,
                                    color: "#fff"
                                }
                            },
                            emphasis: {
                                itemStyle: {
                                    areaColor: 'rgba(32, 124, 254, 1)',
                                    borderWidth: 1,
                                    borderColor: 'rgba(0, 255, 246, 1)'
                                }
                            },
                            data: this.mapData[i].data
                        }]
                    })
                }
                $mapBox.setOption(option);

                let index = 0; //播放所在下标
                // this.mTime = setInterval(function() {
                //     $mapBox.dispatchAction({
                //         type: 'showTip',
                //         seriesIndex: 0,
                //         dataIndex: index
                //     });
                //     index++;
                //     if (index >= option.options.series[0].data.length) {
                //         index = 0;
                //     }
                //     clearInterval(this.mTime)
                // }, 2000);
            },
            initMap() {
                // mapBox
                let $mapBox = echarts.init(document.getElementById("mapBox"))

                // 指定图表的配置项和数据
                let option = barOptionMobiSub = {
                    baseOption: {
                        timeline: {
                            axisType: 'category',
                            realtime: true,
                            autoPlay: false,
                            symbolSize: 8,
                            orient: 'vertical',
                            inverse: true,
                            // z: 2,
                            top: 30,
                            right: 'auto',
                            bottom: 10,
                            left: '80%',
                            data: [],
                            label: {
                                interval: 0,
                                color: '#1781bf'
                            },
                            // symbol: 'roundRect',
                            symbol: 'pin',
                            lineStyle: {
                                show: true,
                                color: '#1781bf',
                                width: 1,
                                type: 'dotted'
                            },
                            controlStyle: {
                                showPlayBtn: false,
                                showPrevBtn: false,
                                showNextBtn: false
                            },
                            itemStyle: {
                                color: '#1781bf'
                            },
                            checkpointStyle: {
                                symbol: 'none'
                            },
                            tooltip: {
                                formatter: []
                            },
                            grid: {
                                containLabel: true
                            },
                            series: [{
                                type: 'bar'
                            }]
                        }
                    },
                    options: [{
                        title: {
                            text: '',
                            left: '30%'
                        },
                        legend: {
                            data: ['累积流量', '累积耗电'],
                            orient: 'vertical',
                            left: 0
                        },
                        toolbox: {
                            feature: {
                                dataView: {}
                            }
                        },
                        tooltip: {},
                        xAxis: {
                            position: 'top',
                            axisLabel: {
                                rotate: 45
                            }
                        },
                        yAxis: {
                            data: [],
                            splitLine: {
                                show: false
                            },
                            axisLabel: {
                                interval: 0,
                                rotate: -45
                            },
                            offset: 0,
                            gridIndex: 0,
                            triggerEvent: true
                        },
                        grid: {
                            left: '20%',
                            right: '20%'
                                // bottom: 80
                        },
                        series: [{
                            name: '累积流量',
                            type: 'bar',
                            data: [],
                            animationDelay: function(idx) {
                                return idx * 10
                            }
                        }, {
                            name: '累积耗电',
                            type: 'bar',
                            data: [],
                            animationDelay: function(idx) {
                                return idx * 10 + 100
                            }
                        }],
                        animationEasing: 'elasticOut',
                        animationDelayUpdate: function(idx) {
                            return idx * 5
                        }
                    }]
                }

                // 使用刚指定的配置项和数据显示图表。
                $mapBox.setOption(option);
            },
        },
    })
</script>

</html>